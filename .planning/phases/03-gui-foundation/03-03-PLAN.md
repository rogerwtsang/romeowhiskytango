---
phase: 03-gui-foundation
plan: 03
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - src/gui/dashboard/lineup_panel.py
  - src/gui/dashboard/__init__.py
autonomous: true

must_haves:
  truths:
    - "User can build lineup with drag-and-drop controls"
    - "User can run simulation from within lineup panel"
    - "User sees progress indicator inline near Run button during simulation"
  artifacts:
    - path: "src/gui/dashboard/lineup_panel.py"
      provides: "Lineup panel with integrated run controls and progress"
      min_lines: 120
      exports: ["LineupPanel"]
  key_links:
    - from: "LineupPanel"
      to: "LineupBuilder widget"
      via: "composition for lineup editing"
      pattern: "self\\.lineup_builder.*LineupBuilder"
    - from: "LineupPanel.run_btn"
      to: "on_run callback"
      via: "command parameter"
      pattern: "command=self\\._on_run"
    - from: "LineupPanel.update_progress"
      to: "ttk.Progressbar"
      via: "progress value updates with self.update()"
      pattern: "self\\.progress\\['value'\\].*self\\.update\\(\\)"
---

<objective>
Create LineupPanel that integrates lineup building with simulation controls, including Run button and inline progress indicator.

Purpose: Consolidate lineup editing and simulation execution in single contextual panel, eliminating need to switch tabs.

Output: LineupPanel ready for dashboard integration, with lineup editing, run controls, and progress display.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-gui-foundation/03-CONTEXT.md
@.planning/phases/03-gui-foundation/03-RESEARCH.md
@src/gui/tabs/lineup_tab.py
@src/gui/tabs/run_tab.py
@src/gui/widgets/lineup_builder.py
@src/gui/utils/simulation_runner.py
</context>

<tasks>

<task type="auto">
  <name>Create LineupPanel with integrated controls</name>
  <files>src/gui/dashboard/lineup_panel.py</files>
  <action>
Create src/gui/dashboard/lineup_panel.py with LineupPanel class.

Implementation requirements:
- Inherit from ttk.Frame
- __init__ accepts parent, on_run callback (optional), on_compare callback (optional)
- Use grid geometry manager with proper weights (RESEARCH.md Pattern 4)

Grid configuration:
- columnconfigure(0, weight=1)  # Main content column (expands)
- columnconfigure(1, weight=0)  # Control buttons column (fixed)
- rowconfigure(0, weight=0)     # Header row (fixed)
- rowconfigure(1, weight=1)     # Lineup builder row (expands)
- rowconfigure(2, weight=0)     # Footer/Run controls row (fixed)

Header (row 0):
- ttk.Label with "Batting Order" title (font=('TkDefaultFont', 12, 'bold'))
- If on_compare callback provided, add "Compare Mode" button aligned right

Content (row 1):
- LineupBuilder widget in column 0 (existing widget from lineup_tab.py)
- Control buttons in column 1 (Add, Move Up, Move Down, Remove)
- Use sticky='nsew' for lineup builder to fill cell
- Use sticky='ns' for control buttons

Footer (row 2):
- Run button: ttk.Button with text="â–¶ Run Simulation", command=self._on_run
- Progress bar: ttk.Progressbar with mode='determinate', length=200, initially hidden
- Progress label: ttk.Label initially hidden
- Use pack() within footer frame (safe to mix managers in different frames per RESEARCH.md)

Methods:
- _on_run(): calls self.on_run callback if provided
- update_progress(current, total): Shows progress bar if hidden, updates percentage, calls self.update() to force UI refresh (RESEARCH.md Pitfall 6)
- hide_progress(): Hides progress bar and label
- get_lineup_data(): Returns current lineup from LineupBuilder
- set_lineup_data(data): Sets lineup in LineupBuilder (for session restoration)

Follow RESEARCH.md Pattern 5 for inline progress indicator.
Use direct label.config(text=...) for progress label (no StringVar - RESEARCH.md Pitfall 2).

Type hints, Google-style docstrings, project conventions.
  </action>
  <verify>
    - File exists at src/gui/dashboard/lineup_panel.py
    - LineupPanel class inherits from ttk.Frame
    - Contains update_progress(), hide_progress(), get_lineup_data(), set_lineup_data() methods
    - Progress updates include self.update() call for UI refresh
    - mypy src/gui/dashboard/lineup_panel.py shows no errors
  </verify>
  <done>
LineupPanel created with integrated LineupBuilder, control buttons, Run button, and inline progress indicator following RESEARCH.md patterns.
  </done>
</task>

<task type="auto">
  <name>Add LineupPanel to dashboard package exports</name>
  <files>src/gui/dashboard/__init__.py</files>
  <action>
Add LineupPanel to dashboard package exports.

Add import:
```python
from src.gui.dashboard.lineup_panel import LineupPanel
```

Update __all__ to include "LineupPanel":
```python
__all__ = ["SetupPanel", "LineupPanel"]
```
  </action>
  <verify>
    - LineupPanel in src/gui/dashboard/__init__.py
    - python -c "from src.gui.dashboard import LineupPanel; print(LineupPanel)" runs without error
  </verify>
  <done>
LineupPanel exported from dashboard package and importable.
  </done>
</task>

</tasks>

<verification>
Run mypy:
```bash
mypy src/gui/dashboard/lineup_panel.py
```

Verify import:
```bash
python -c "from src.gui.dashboard import LineupPanel; print(LineupPanel.__name__)"
```

Test instantiation:
```bash
python -c "
import tkinter as tk
from src.gui.dashboard import LineupPanel
root = tk.Tk()
panel = LineupPanel(root)
print('LineupPanel instantiated')
# Test progress updates
panel.update_progress(50, 100)
print('Progress updated to 50%')
panel.hide_progress()
print('Progress hidden')
root.destroy()
"
```
</verification>

<success_criteria>
- LineupPanel integrates LineupBuilder with Run controls
- Run button and progress indicator in footer row
- Progress bar shows inline when update_progress() called
- update_progress() calls self.update() for UI refresh
- Grid weights configured for responsive layout
- get_lineup_data() and set_lineup_data() methods exist for session management
- No mypy errors
- Panel instantiates without errors
</success_criteria>

<output>
After completion, create `.planning/phases/03-gui-foundation/03-03-SUMMARY.md`
</output>
