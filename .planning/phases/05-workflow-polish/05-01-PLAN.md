---
phase: 05-workflow-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - gui.py
  - src/gui/dashboard/setup_panel.py
  - src/gui/dashboard/main_dashboard.py
  - src/gui/widgets/seed_control.py
autonomous: true

must_haves:
  truths:
    - "Window opens at half screen width, full screen height"
    - "Config panels scale to 1/4 window width with 250px minimum"
    - "Seed shows current value in box"
    - "Seed randomizes on each Run click when unlocked"
    - "Lock toggle changes visual state and enables/disables input"
    - "Default simulation count is 2000"
  artifacts:
    - path: "src/gui/widgets/seed_control.py"
      provides: "SeedControl widget with lock/unlock toggle"
      exports: ["SeedControl"]
    - path: "gui.py"
      provides: "Window sizing based on screen dimensions"
      contains: "winfo_screenwidth"
    - path: "src/gui/dashboard/setup_panel.py"
      provides: "Updated simulation defaults and SeedControl integration"
      contains: "SeedControl"
  key_links:
    - from: "gui.py"
      to: "root.geometry"
      via: "screen dimension calculation"
      pattern: "winfo_screen(width|height)"
    - from: "src/gui/dashboard/setup_panel.py"
      to: "src/gui/widgets/seed_control.py"
      via: "SeedControl widget import and instantiation"
      pattern: "SeedControl"
---

<objective>
Establish responsive window sizing and improved seed control UX.

Purpose: Create foundation for workflow polish with proper window defaults and seed randomization behavior that reduces friction.

Output:
- SeedControl widget with lock/unlock toggle
- Window opens at half screen width, full height
- Config panels constrained to 1/4 width with 250px minimum
- Default simulations changed to 2000
</objective>

<execution_context>
@/home/roger/.claude/get-shit-done/workflows/execute-plan.md
@/home/roger/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/05-workflow-polish/05-CONTEXT.md
@.planning/phases/05-workflow-polish/05-RESEARCH.md

# Key source files
@gui.py
@src/gui/dashboard/setup_panel.py
@src/gui/dashboard/main_dashboard.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SeedControl widget with lock/unlock behavior</name>
  <files>src/gui/widgets/seed_control.py, src/gui/widgets/__init__.py</files>
  <action>
Create new SeedControl widget class in src/gui/widgets/seed_control.py:

1. SeedControl(ttk.Frame):
   - Entry box for displaying/editing seed value (width=12)
   - Lock/unlock toggle button (width=8)
   - State: self.locked = False (unlocked by default)

2. Behavior:
   - When unlocked: Entry is disabled (greyed out), button shows "Unlocked"
   - When locked: Entry is enabled (editable), button shows "Locked"
   - On init: Generate random seed and display it

3. Methods:
   - _toggle_lock(): Toggle locked state, update entry state, randomize if newly unlocked
   - _randomize_seed(): Generate random.randint(0, 2**31 - 1), update entry
   - get_seed() -> int: If unlocked, randomize first; return current seed value
   - is_locked() -> bool: Return locked state

4. Visual feedback:
   - Use ttk.Entry.configure(state='normal'/'disabled') for greyed out effect
   - Button text changes: "Locked" vs "Unlocked"

Add SeedControl to src/gui/widgets/__init__.py exports.

Reference RESEARCH.md Pattern 3 for implementation details.
  </action>
  <verify>
python -c "from src.gui.widgets import SeedControl; print('SeedControl imported successfully')"
  </verify>
  <done>SeedControl widget exists with lock/unlock toggle, randomize-by-default behavior, and get_seed() method</done>
</task>

<task type="auto">
  <name>Task 2: Update window sizing and simulation defaults</name>
  <files>gui.py, src/gui/dashboard/setup_panel.py, src/gui/dashboard/main_dashboard.py</files>
  <action>
1. In gui.py, update MonteCarloBaseballGUI.__init__():
   - Replace hardcoded "1200x800" geometry with screen-relative sizing:
   ```python
   screen_width = root.winfo_screenwidth()
   screen_height = root.winfo_screenheight()
   window_width = screen_width // 2
   window_height = screen_height
   root.geometry(f"{window_width}x{window_height}+0+0")
   ```

2. In setup_panel.py:
   - Change default N_SIMULATIONS from 1000 to 2000 in _load_defaults()
   - Replace existing seed checkbox/entry with SeedControl widget:
     - Import SeedControl from src.gui.widgets
     - Replace use_seed_var, use_seed_check, seed_entry with self.seed_control = SeedControl(seed_frame)
     - Update get_config() to use self.seed_control.get_seed() and self.seed_control.is_locked()
   - Delete _on_seed_toggle() method (no longer needed)

3. In main_dashboard.py, add minimum width constraint:
   - After creating self.main_paned, bind '<Configure>' to enforce minimum left panel width
   - Minimum width: 250px absolute
   - Reference RESEARCH.md Pattern 5 for ConstrainedPanedWindow approach
   - Alternatively, add simpler after_idle check in _create_layout()

Reference RESEARCH.md Patterns 4 and 5 for window sizing and minimum constraints.
  </action>
  <verify>
python -c "
import tkinter as tk
root = tk.Tk()
root.withdraw()  # Hide window
sw = root.winfo_screenwidth()
sh = root.winfo_screenheight()
print(f'Screen: {sw}x{sh}, Expected window: {sw//2}x{sh}')
root.destroy()
"
  </verify>
  <done>Window opens at half screen width/full height, default simulations is 2000, seed uses SeedControl widget with lock/unlock behavior</done>
</task>

</tasks>

<verification>
1. Launch GUI: `python gui.py`
2. Verify window is half screen width, full screen height
3. Verify seed shows a random number, is greyed out (unlocked state)
4. Click "Unlocked" button - verify it changes to "Locked", seed becomes editable
5. Click "Locked" button - verify it changes to "Unlocked", seed is regenerated and greyed out
6. Verify default simulations slider/entry shows 2000
7. Resize left panel - verify it cannot shrink below 250px
</verification>

<success_criteria>
- Window opens at correct size based on screen dimensions
- SeedControl widget provides lock/unlock toggle with visual feedback
- Seed randomizes on each Run when unlocked
- Default simulation count is 2000
- Left config panel has 250px minimum width
</success_criteria>

<output>
After completion, create `.planning/phases/05-workflow-polish/05-01-SUMMARY.md`
</output>
