---
phase: 05-workflow-polish
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/gui/dashboard/setup_panel.py
  - src/gui/widgets/collapsible_frame.py
autonomous: true

must_haves:
  truths:
    - "Assumptions section is expanded (visible) by default on startup"
    - "Each assumption toggle has expandable explanation text"
    - "Clicking assumption label reveals/hides explanation"
    - "User can still collapse entire Assumptions section if desired"
  artifacts:
    - path: "src/gui/dashboard/setup_panel.py"
      provides: "Assumptions expanded by default with inline explanations"
      contains: "explanation"
    - path: "src/gui/widgets/collapsible_frame.py"
      provides: "CollapsibleFrame initialized expanded by default"
      contains: "collapsed=False"
  key_links:
    - from: "src/gui/dashboard/setup_panel.py"
      to: "CollapsibleFrame"
      via: "assumptions_frame initialization"
      pattern: "CollapsibleFrame.*Assumptions"
---

<objective>
Enhance Assumptions section with explanations and default-expanded state.

Purpose: Make model assumptions discoverable and educational while keeping interface clean. Users can learn what each setting does without external documentation.

Output:
- Assumptions section expanded by default
- Each assumption toggle has associated explanation text
- Explanations expand/collapse independently
</objective>

<execution_context>
@/home/roger/.claude/get-shit-done/workflows/execute-plan.md
@/home/roger/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/05-workflow-polish/05-CONTEXT.md

# Key source files
@src/gui/dashboard/setup_panel.py
@src/gui/widgets/collapsible_frame.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Make Assumptions section expanded by default</name>
  <files>src/gui/widgets/collapsible_frame.py, src/gui/dashboard/setup_panel.py</files>
  <action>
1. In collapsible_frame.py, update CollapsibleFrame.__init__():
   - Add parameter: collapsed: bool = False (default to expanded)
   - Set self.collapsed = collapsed in __init__
   - If collapsed=True passed, call toggle() after widget creation to start collapsed

2. In setup_panel.py, the assumptions_frame is currently toggled to collapse after creation.
   Remove the line that calls toggle() on assumptions_frame initialization (if any).
   The CollapsibleFrame should now default to expanded.

3. Verify the current toggle behavior in collapsible_frame.py:
   - If toggle() hides content when called on expanded frame, behavior is correct
   - If there's a toggle() call in setup_panel.py for assumptions_frame, remove it
  </action>
  <verify>
python -c "
from src.gui.widgets.collapsible_frame import CollapsibleFrame
import tkinter as tk
root = tk.Tk()
root.withdraw()
cf = CollapsibleFrame(root, text='Test')
cf.pack()
print(f'Default collapsed state: {cf.collapsed}')
assert cf.collapsed == False, 'Should be expanded by default'
print('Verified: CollapsibleFrame expanded by default')
root.destroy()
"
  </verify>
  <done>Assumptions section is expanded (visible) on startup instead of collapsed</done>
</task>

<task type="auto">
  <name>Task 2: Add expandable explanations for each assumption</name>
  <files>src/gui/dashboard/setup_panel.py</files>
  <action>
Add explanation text for each assumption toggle in setup_panel.py's _create_assumptions_section().

For each assumption checkbox, add a collapsible explanation label below it:

1. Create helper method _create_assumption_with_explanation(parent, text, var, explanation, command=None):
   - Create ttk.Frame container
   - Add ttk.Checkbutton with text and variable
   - Add ttk.Label for explanation with:
     - foreground='gray'
     - wraplength=300 (for text wrapping)
     - Initially hidden (pack_forget)
   - Bind checkbox label click to toggle explanation visibility
   - Return frame, checkbox, explanation_label

2. Replace existing assumption checkboxes with explained versions:

   **Stolen Bases:**
   "Simulates stolen base attempts based on player speed and catcher arm. Attempt frequency scales with player's historical SB rate."

   **Probabilistic Baserunning:**
   "Models runner advancement using real-world probabilities. Without this, runners always advance exactly one base per single."

   **Sacrifice Flies:**
   "Allows runners on 3rd to score on fly outs with less than 2 outs. Flyout percentage controls how often outs are fly balls."

   **Errors & Wild Pitches:**
   "Adds random errors that advance runners. Error rate controls frequency. Higher rates favor contact-heavy lineups."

3. For sliders below toggles, add brief inline help text:
   - Already have some help text (e.g., "(0.0 = Never, 1.0 = Normal...")
   - These are adequate, no changes needed for sliders

4. Add expand/collapse indicator to checkbox labels:
   - Use "(i)" or similar indicator after checkbox text
   - Click on indicator toggles explanation visibility
  </action>
  <verify>
python -c "
# Verify setup_panel has explanation patterns
import inspect
from src.gui.dashboard.setup_panel import SetupPanel
source = inspect.getsource(SetupPanel)
assert 'explanation' in source.lower() or 'explain' in source.lower(), 'No explanation code found'
print('Explanation code present in SetupPanel')
"
  </verify>
  <done>Each assumption toggle has associated explanation text that can be shown/hidden</done>
</task>

</tasks>

<verification>
1. Launch GUI: `python gui.py`
2. Verify Assumptions section is EXPANDED by default (not collapsed)
3. Look at Stolen Bases checkbox - verify there's an info indicator or way to see explanation
4. Click to expand explanation - verify text appears describing what stolen bases simulation does
5. Collapse explanation - verify it hides
6. Repeat for other assumption toggles
7. Verify entire Assumptions section can still be collapsed via section header
</verification>

<success_criteria>
- Assumptions section starts expanded
- Each assumption toggle has explanation text
- Explanations are hidden by default but expandable
- Explanation text is helpful and describes what the setting does
</success_criteria>

<output>
After completion, create `.planning/phases/05-workflow-polish/05-02-SUMMARY.md`
</output>
